import React from 'react';
import { AbsoluteFill, useCurrentFrame } from 'remotion';

interface SplitScreenProps {
  left?: React.ReactNode;
  right?: React.ReactNode;
  top?: React.ReactNode;
  bottom?: React.ReactNode;
  startFrame: number;
  durationInFrames: number;
  dividerWidth?: number;
  dividerColor?: string;
  gap?: number;
  orientation?: 'horizontal' | 'vertical';
}

export const SplitScreen: React.FC<SplitScreenProps> = ({
  left,
  right,
  top,
  bottom,
  startFrame,
  durationInFrames,
  dividerWidth = [[ config.divider_width or 2 ]],
  dividerColor = '[[ config.divider_color or colors.accent[0] ]]',
  gap = [[ config.gap or 20 ]],
  orientation = '[[ config.orientation or "horizontal" ]]',
}) => {
  const frame = useCurrentFrame();

  // Don't render if outside the time range
  if (frame < startFrame || frame >= startFrame + durationInFrames) {
    return null;
  }

  const isHorizontal = orientation === 'horizontal';

  return (
    <AbsoluteFill
      style={{
        display: 'flex',
        flexDirection: isHorizontal ? 'row' : 'column',
        gap,
        padding: [[ config.padding or 40 ]],
        backgroundColor: '[[ config.background_color or colors.background.dark ]]',
      }}
    >
      <div style={{ flex: 1 }}>
        {isHorizontal ? left : top}
      </div>

      <div
        style={{
          width: isHorizontal ? dividerWidth : '100%',
          height: isHorizontal ? '100%' : dividerWidth,
          background: dividerColor,
        }}
      />

      <div style={{ flex: 1 }}>
        {isHorizontal ? right : bottom}
      </div>
    </AbsoluteFill>
  );
};
